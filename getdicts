#!/bin/bash

IN="pl_PL"
OUT="polish"
ENCODING="ISO8859-2"

echo "Generating files for \"$IN\" language"

wget http://src.chromium.org/svn/trunk/deps/third_party/hunspell_dictionaries/$IN.dic
wget http://src.chromium.org/svn/trunk/deps/third_party/hunspell_dictionaries/$IN.dic_delta
wget http://src.chromium.org/svn/trunk/deps/third_party/hunspell_dictionaries/$IN.aff -O $IN.affix

# Remove first line
sed -i '' 1d $IN.dic

# Encode as UTF-8
iconv -f $ENCODING -t utf8 $IN.dic > $IN.utf.dic
iconv -f $ENCODING -t utf8 $IN.affix > $OUT.affix

# Switch back .utf for dic
rm $IN.dic
mv $IN.utf.dic $IN.dic

# Concat the dic and dic_delta, sort alphabetically and remove the leading blank line (leaves the ending newline intact)
export LC_ALL='pl_PL.UTF-8'
cat $IN.dic $IN.dic_delta | sort > $OUT.dict
sed -i '' 1d $OUT.dict

# Remove temp files
rm $IN.dic $IN.dic_delta $IN.affix


echo "Finished!"